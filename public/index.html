<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Portfolio Builder</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { 
            text-align: center; 
            color: white; 
            margin-bottom: 30px;
            padding-top: 20px;
        }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        .tagline { font-size: 1.1em; opacity: 0.9; }
        
        .language-toggle {
            text-align: center;
            margin-bottom: 20px;
        }
        .language-toggle button {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid white;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        .language-toggle button.active {
            background: white;
            color: #667eea;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            h1 { font-size: 1.8em; }
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card h2 { color: #333; margin-bottom: 20px; font-size: 1.3em; }
        
        label {
            display: block;
            margin-top: 15px;
            color: #555;
            font-weight: 600;
            font-size: 14px;
        }
        
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }
        
        input[type="text"]:focus,
        select:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #ddd;
            border-top: none;
            border-radius: 0 0 6px 6px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .search-results.active { display: block; }
        
        .search-result-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .search-result-item:hover {
            background: #f5f5f5;
        }
        
        .search-result-name {
            font-weight: 600;
            color: #333;
        }
        
        .search-result-meta {
            font-size: 12px;
            color: #999;
            margin-top: 4px;
        }
        
        .selected-product {
            background: #f0f0f0;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .selected-product-name {
            font-weight: 600;
            color: #333;
        }
        
        .remove-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-btn:hover { background: #ff5252; }
        
        button {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
        }
        
        button:hover { background: #764ba2; }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .preset-buttons button {
            margin: 0;
            padding: 10px;
        }
        
        .radio-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .radio-option input {
            display: none;
        }
        
        .radio-option label {
            display: block;
            padding: 10px;
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            margin: 0;
            font-weight: 500;
        }
        
        .radio-option input:checked + label {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .results {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }
        
        .results.show { display: block; }
        
        .result-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }
        
        .result-amount { 
            font-size: 1.3em; 
            font-weight: 700; 
            color: #667eea; 
        }
        
        .chart-container {
            position: relative;
            height: 350px;
            margin-top: 20px;
            display: none;
        }
        
        .chart-container.active { display: block; }
        
        .export-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .export-buttons button {
            margin: 0;
            padding: 10px;
            font-size: 14px;
        }
        
        footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            opacity: 0.8;
        }
        
        .product-info {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
            color: #666;
        }
        
        .product-info div {
            margin: 4px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Universal Portfolio Builder</h1>
            <p class="tagline" id="tagline">Build your perfect investment portfolio in 30 seconds</p>
        </header>
        
        <div class="language-toggle">
            <button class="active" onclick="setLanguage('nl')">üá≥üá± Nederlands</button>
            <button onclick="setLanguage('en')">üá¨üáß English</button>
        </div>
        
        <div class="main-content">
            <div class="card">
                <h2 id="step1-title">Step 1: Choose Your Products</h2>
                
                <div class="search-box">
                    <label for="productSearch" id="search-label">Search products (name, ticker, ISIN)</label>
                    <input type="text" id="productSearch" placeholder="Search SNAW, Bitcoin, Gold...">
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div id="selectedProducts"></div>
                
                <h2 style="margin-top: 30px;" id="step2-title">Step 2: Your Budget</h2>
                
                <div class="preset-buttons">
                    <button onclick="setBudget(500)">‚Ç¨500</button>
                    <button onclick="setBudget(1000)">‚Ç¨1000</button>
                    <button onclick="setBudget(1500)">‚Ç¨1500</button>
                </div>
                
                <label for="customBudget" id="custom-label">Or enter custom amount:</label>
                <input type="number" id="customBudget" placeholder="‚Ç¨750" value="1000">
                
                <h2 style="margin-top: 30px;" id="step3-title">Step 3: Risk Profile</h2>
                
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="risk" id="risk1" value="conservative">
                        <label for="risk1" id="risk1-label">Conservative</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="risk" id="risk2" value="balanced" checked>
                        <label for="risk2" id="risk2-label">Balanced ‚≠ê</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="risk" id="risk3" value="growth">
                        <label for="risk3" id="risk3-label">Growth</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="risk" id="risk4" value="aggressive">
                        <label for="risk4" id="risk4-label">Aggressive</label>
                    </div>
                </div>
                
                <button onclick="calculate()" style="margin-top: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" id="calc-btn">üìä Calculate Allocation</button>
            </div>
            
            <div class="card">
                <h2 id="results-title">Your Portfolio</h2>
                <div id="chartContainer" class="chart-container">
                    <canvas id="allocationChart"></canvas>
                </div>
                <div id="noResults" style="text-align:center; color:#999; padding:40px;" id="no-results-msg">
                    üëà Select products and click Calculate
                </div>
                <div id="results"></div>
            </div>
        </div>
        
        <footer>
            <p>¬© 2025 Universal Portfolio Builder | Free & Open Source</p>
            <p style="margin-top: 10px; font-size: 0.9em;">
                <a href="mailto:your-email@gmail.com" style="color: white; text-decoration: underline;">Feedback</a> | 
                <a href="https://github.com" style="color: white; text-decoration: underline;">GitHub</a>
            </p>
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let chart = null;
        let selectedProducts = [];
        let currentLanguage = 'nl';
        
        const translations = {
            nl: {
                tagline: 'Bouw je perfecte investeringsportefeuille in 30 seconden',
                step1: 'Stap 1: Kies je producten',
                step2: 'Stap 2: Je budget',
                step3: 'Stap 3: Risicoprofiel',
                search: 'Zoeken (naam, ticker, ISIN)',
                custom: 'Of voer custom bedrag in:',
                conservative: 'Conservatief',
                balanced: 'Gebalanceerd ‚≠ê',
                growth: 'Groei',
                aggressive: 'Agressief',
                calculate: 'üìä Bereken allocatie',
                portfolio: 'Je portefeuille',
                selectMsg: 'üëà Selecteer producten en klik Bereken',
                allocation: 'üìä Je allocatie',
                exportJSON: 'Export JSON',
                exportCSV: 'Export CSV',
                noProducts: 'Selecteer tenminste 1 product',
                results: 'Resultaten'
            },
            en: {
                tagline: 'Build your perfect investment portfolio in 30 seconds',
                step1: 'Step 1: Choose Your Products',
                step2: 'Step 2: Your Budget',
                step3: 'Step 3: Risk Profile',
                search: 'Search (name, ticker, ISIN)',
                custom: 'Or enter custom amount:',
                conservative: 'Conservative',
                balanced: 'Balanced ‚≠ê',
                growth: 'Growth',
                aggressive: 'Aggressive',
                calculate: 'üìä Calculate Allocation',
                portfolio: 'Your Portfolio',
                selectMsg: 'üëà Select products and click Calculate',
                allocation: 'üìä Your Allocation',
                exportJSON: 'Export JSON',
                exportCSV: 'Export CSV',
                noProducts: 'Select at least 1 product',
                results: 'Results'
            }
        };
        
        const products = [
            { name: 'iShares MSCI World Screened', ticker: 'SNAW', isin: 'IE00BFNM3J75', type: 'World ETF', ter: '0.20%', risk: 'Medium', holdings: 1218 },
            { name: 'iShares MSCI EM IMI Screened', ticker: 'AYEM', isin: 'IE00BFNM3P36', type: 'EM ETF', ter: '0.18%', risk: 'High', holdings: 2687 },
            { name: 'iShares Core MSCI World', ticker: 'IWDA', isin: 'IE00B4L5Y983', type: 'World ETF', ter: '0.20%', risk: 'Medium', holdings: 1504 },
            { name: 'Vanguard FTSE All-World', ticker: 'VWRL', isin: 'IE00B8KQN627', type: 'World ETF', ter: '0.22%', risk: 'Medium', holdings: 3000 },
            { name: 'iShares MSCI USA', ticker: 'EUSA', isin: 'IE00BJ0KDQ92', type: 'US ETF', ter: '0.07%', risk: 'Medium', holdings: 626 },
            { name: 'iShares Core Euro Government Bond', ticker: 'IEGA', isin: 'IE00B4WXJJ64', type: 'Bond ETF', ter: '0.07%', risk: 'Low', holdings: 514 },
            { name: 'iShares Euro High Yield Corporate', ticker: 'IEHY', isin: 'IE00B0M63984', type: 'Bond ETF', ter: '0.35%', risk: 'Medium', holdings: 300 },
            { name: 'Invesco Physical Gold A', ticker: '8PSG', isin: 'IE00B579F325', type: 'Commodity', ter: '0.12%', risk: 'Medium', holdings: 0 },
            { name: 'Bitcoin', ticker: 'BTC', isin: 'N/A', type: 'Crypto', ter: 'Variable', risk: 'Very High', holdings: 0 },
            { name: 'Ethereum', ticker: 'ETH', isin: 'N/A', type: 'Crypto', ter: 'Variable', risk: 'Very High', holdings: 0 },
            { name: 'iShares MSCI Japan', ticker: 'CJPN', isin: 'IE00BKM4GZ67', type: 'Regional ETF', ter: '0.48%', risk: 'Medium', holdings: 319 },
            { name: 'iShares MSCI Europe', ticker: 'IEUR', isin: 'IE00BD1F4K48', type: 'Regional ETF', ter: '0.20%', risk: 'Medium', holdings: 450 },
            { name: 'iShares Global Clean Energy', ticker: 'ICLN', isin: 'IE00B1XNRQ01', type: 'Thematic ETF', ter: '0.65%', risk: 'High', holdings: 100 },
            { name: 'Xtrackers MSCI World', ticker: 'XWDA', isin: 'IE00BTJRMP35', type: 'World ETF', ter: '0.12%', risk: 'Medium', holdings: 1500 },
            { name: 'iShares Core MSCI ACWX UCITS ETF', ticker: 'EUNL', isin: 'IE00B0M63284', type: 'World ETF', ter: '0.30%', risk: 'Medium', holdings: 1600 },
            { name: 'Lyxor Core MSCI World', ticker: 'LCWD', isin: 'FR0011869576', type: 'World ETF', ter: '0.12%', risk: 'Medium', holdings: 1500 },
            { name: 'Vanguard FTSE European', ticker: 'VERX', isin: 'IE00B945VV12', type: 'Regional ETF', ter: '0.10%', risk: 'Medium', holdings: 500 },
            { name: 'Vanguard U.S. Equity Index', ticker: 'VUSA', isin: 'IE00B3RBWM25', type: 'US ETF', ter: '0.08%', risk: 'Medium', holdings: 3600 },
            { name: 'iShares Physical Silver', ticker: 'SLV', isin: 'US4642881175', type: 'Commodity', ter: '0.30%', risk: 'Medium', holdings: 0 },
            { name: 'Global X Bitcoin Mini Trust', ticker: 'BTCM', isin: 'US37959S1031', type: 'Crypto', ter: '0.20%', risk: 'Very High', holdings: 0 },
            { name: 'Grayscale Bitcoin Mini Trust', ticker: 'BTC', isin: 'US37959S1031', type: 'Crypto', ter: '0.25%', risk: 'Very High', holdings: 0 },
            { name: 'iShares Dividend & Income Fund', ticker: 'VYMI', isin: 'IE00B5M1VJ87', type: 'Dividend ETF', ter: '0.30%', risk: 'Medium', holdings: 400 },
            { name: 'Vanguard Total Bond Market ETF', ticker: 'BND', isin: 'US9220428588', type: 'Bond ETF', ter: '0.03%', risk: 'Low', holdings: 7000 },
            { name: 'iShares MSCI Emerging Markets', ticker: 'EEM', isin: 'US4642881175', type: 'EM ETF', ter: '0.68%', risk: 'High', holdings: 1800 },
            { name: 'iShares Global Tech ETF', ticker: 'IEMG', isin: 'IE00B4L5Y983', type: 'Tech ETF', ter: '0.40%', risk: 'High', holdings: 600 },
            { name: 'Vanguard Real Estate ETF', ticker: 'VNQ', isin: 'US9229087690', type: 'REIT ETF', ter: '0.12%', risk: 'Medium', holdings: 200 },
            { name: 'Cash/Savings', ticker: 'CASH', isin: 'N/A', type: 'Cash', ter: '0.00%', risk: 'Low', holdings: 0 },
            { name: 'iShares Core S&P 500', ticker: 'IVV', isin: 'US4642881175', type: 'US ETF', ter: '0.03%', risk: 'Medium', holdings: 500 },
            { name: 'Vanguard Dividend Appreciation ETF', ticker: 'VIG', isin: 'US9229087690', type: 'Dividend ETF', ter: '0.06%', risk: 'Medium', holdings: 300 },
            { name: 'iShares Global Select Dividend ETF', ticker: 'IUSD', isin: 'IE00B2QWCY14', type: 'Dividend ETF', ter: '0.39%', risk: 'Medium', holdings: 80 }
        ];
        
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll(`[onclick*="setLanguage"]`).forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('tagline').textContent = translations[lang].tagline;
            document.getElementById('step1-title').textContent = translations[lang].step1;
            document.getElementById('step2-title').textContent = translations[lang].step2;
            document.getElementById('step3-title').textContent = translations[lang].step3;
            document.getElementById('search-label').textContent = translations[lang].search;
            document.getElementById('custom-label').textContent = translations[lang].custom;
            document.getElementById('risk1-label').textContent = translations[lang].conservative;
            document.getElementById('risk2-label').textContent = translations[lang].balanced;
            document.getElementById('risk3-label').textContent = translations[lang].growth;
            document.getElementById('risk4-label').textContent = translations[lang].aggressive;
            document.getElementById('calc-btn').textContent = translations[lang].calculate;
            document.getElementById('results-title').textContent = translations[lang].portfolio;
            document.getElementById('no-results-msg').textContent = translations[lang].selectMsg;
        }
        
        function fuzzySearch(query, list) {
            if (!query) return [];
            const q = query.toLowerCase();
            return list.filter(item => {
                const name = item.name.toLowerCase();
                const ticker = item.ticker.toLowerCase();
                const isin = item.isin.toLowerCase();
                return name.includes(q) || ticker.includes(q) || isin.includes(q);
            }).slice(0, 8);
        }
        
        document.getElementById('productSearch').addEventListener('input', (e) => {
            const query = e.target.value;
            const results = fuzzySearch(query, products);
            const resultsDiv = document.getElementById('searchResults');
            
            if (query.length > 0 && results.length > 0) {
                resultsDiv.classList.add('active');
                resultsDiv.innerHTML = results.map(p => `
                    <div class="search-result-item" onclick="selectProduct('${p.ticker}')">
                        <div class="search-result-name">${p.ticker} - ${p.name}</div>
                        <div class="search-result-meta">ISIN: ${p.isin} | TER: ${p.ter} | Risk: ${p.risk}</div>
                    </div>
                `).join('');
            } else {
                resultsDiv.classList.remove('active');
            }
        });
        
        function selectProduct(ticker) {
            const product = products.find(p => p.ticker === ticker);
            if (product && !selectedProducts.find(p => p.ticker === ticker)) {
                selectedProducts.push(product);
                renderSelected();
                document.getElementById('productSearch').value = '';
                document.getElementById('searchResults').classList.remove('active');
            }
        }
        
        function removeProduct(ticker) {
            selectedProducts = selectedProducts.filter(p => p.ticker !== ticker);
            renderSelected();
        }
        
        function renderSelected() {
            const container = document.getElementById('selectedProducts');
            container.innerHTML = selectedProducts.map(p => `
                <div class="selected-product">
                    <div>
                        <div class="selected-product-name">${p.ticker} - ${p.name}</div>
                        <div class="product-info">
                            <div>ISIN: ${p.isin} | TER: ${p.ter}</div>
                        </div>
                    </div>
                    <button class="remove-btn" onclick="removeProduct('${p.ticker}')">Remove</button>
                </div>
            `).join('');
        }
        
        function setBudget(amount) {
            document.getElementById('customBudget').value = amount;
        }
        
        function calculate() {
            if (selectedProducts.length === 0) {
                alert(translations[currentLanguage].noProducts);
                return;
            }
            
            const budget = parseFloat(document.getElementById('customBudget').value) || 1000;
            const risk = document.querySelector('input[name="risk"]:checked').value;
            
            let allocations = [];
            if (selectedProducts.length === 1) {
                allocations = [1];
            } else if (selectedProducts.length === 2) {
                if (risk === 'conservative') allocations = [0.6, 0.4];
                else if (risk === 'balanced') allocations = [0.5, 0.5];
                else if (risk === 'growth') allocations = [0.4, 0.6];
                else allocations = [0.3, 0.7];
            } else {
                const baseAlloc = 1 / selectedProducts.length;
                allocations = selectedProducts.map(() => baseAlloc);
            }
            
            let resultsHTML = `<h3>${translations[currentLanguage].allocation}</h3>`;
            selectedProducts.forEach((p, i) => {
                const amount = budget * allocations[i];
                resultsHTML += `
                    <div class="result-item">
                        <strong>${p.ticker} - ${p.name}</strong><br>
                        <span class="result-amount">‚Ç¨${amount.toFixed(2)}</span> (${(allocations[i]*100).toFixed(0)}%)
                        <div class="product-info">
                            <div>Annual Cost: ‚Ç¨${(amount * parseFloat(p.ter) / 100).toFixed(2)}</div>
                        </div>
                    </div>
                `;
            });
            
            const totalCost = selectedProducts.reduce((sum, p, i) => {
                return sum + (budget * allocations[i] * parseFloat(p.ter) / 100);
            }, 0);
            
            resultsHTML += `
                <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #ddd;">
                    <strong>Total Annual Costs: ‚Ç¨${totalCost.toFixed(2)}</strong>
                </div>
                <div class="export-buttons">
                    <button onclick="exportJSON()">üì• ${translations[currentLanguage].exportJSON}</button>
                    <button onclick="exportCSV()">üì• ${translations[currentLanguage].exportCSV}</button>
                </div>
            `;
            
            document.getElementById('results').innerHTML = resultsHTML;
            document.getElementById('noResults').style.display = 'none';
            document.getElementById('chartContainer').classList.add('active');
            
            const ctx = document.getElementById('allocationChart').getContext('2d');
            if (chart) chart.destroy();
            
            chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: selectedProducts.map(p => p.ticker),
                    datasets: [{
                        data: allocations.map(a => (a*100).toFixed(0)),
                        backgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#ff6b9d', '#ffa502',
                            '#26de81', '#20c997', '#0984e3', '#6c5ce7', '#a29bfe'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }
        
        function exportJSON() {
            const data = {
                products: selectedProducts,
                budget: document.getElementById('customBudget').value,
                riskProfile: document.querySelector('input[name="risk"]:checked').value,
                timestamp: new Date().toISOString()
            };
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            downloadFile(blob, 'portfolio.json');
        }
        
        function exportCSV() {
            let csv = 'Product,Ticker,ISIN,Type,TER,Risk\n';
            selectedProducts.forEach(p => {
                csv += `"${p.name}","${p.ticker}","${p.isin}","${p.type}","${p.ter}","${p.risk}"\n`;
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            downloadFile(blob, 'portfolio.csv');
        }
        
        function downloadFile(blob, filename) {
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
